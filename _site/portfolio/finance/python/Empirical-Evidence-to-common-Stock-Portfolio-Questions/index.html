<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Empirical Evidence to common Stock Portfolio Questions - Econometrics &amp; Data Science</title>
<meta name="description" content="An intuitive and replicable explanation to some of the most important questions of portfolio building">


  <meta name="author" content="Paul Mora">
  
  <meta property="article:author" content="Paul Mora">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Econometrics & Data Science">
<meta property="og:title" content="Empirical Evidence to common Stock Portfolio Questions">
<meta property="og:url" content="http://localhost:4000/portfolio/finance/python/Empirical-Evidence-to-common-Stock-Portfolio-Questions/">


  <meta property="og:description" content="An intuitive and replicable explanation to some of the most important questions of portfolio building">



  <meta property="og:image" content="http://localhost:4000/assets/article_images/portfolio/cover1.png">





  <meta property="article:published_time" content="2020-08-27T00:00:00+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/portfolio/finance/python/Empirical-Evidence-to-common-Stock-Portfolio-Questions/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Paul Mora",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Econometrics & Data Science Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Econometrics & Data Science
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero"
  style=" background-image: url('');"
>
  
    <img src="/assets/article_images/portfolio/cover1.png" alt="Empirical Evidence to common Stock Portfolio Questions" class="page__hero-image">
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/general_images/author.jpg" alt="Paul Mora" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Paul Mora</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Econometrician &amp; Data Scientist at STATWORX</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Germany</span>
        </li>
      

      
        
          
            <li><a href="mailto:paul.michael.mora.sancho@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://github.com/data4help" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/paul-mora-53a727168/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Empirical Evidence to common Stock Portfolio Questions">
    <meta itemprop="description" content="An intuitive and replicable explanation to some of the most important questions of portfolio building">
    <meta itemprop="datePublished" content="2020-08-27T00:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Empirical Evidence to common Stock Portfolio Questions
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p><em>An intuitive and replicable explanation to some of the most important questions of portfolio building</em></p>

<p>At first glance investing seems like rocket science to many people. The sheer amount of possible assets to invest in and the amount of fancy sounding finance terms might seem intimidating. This blog-post elaborates on three of the most asked questions when building a portfolio. This is done by starting with a theoretical explanation and, more importantly, an empirical validation using Python.</p>

<p>We start by loading all the relevant packages and putting the directories for our project in place.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Packages
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="c1"># Paths
</span><span class="n">main_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"/Users/paulmora/Documents/projects/markowitz"</span>
<span class="n">raw_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"{}/00 Raw"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">main_path</span><span class="p">)</span>
<span class="n">code_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"{}/01 Code"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">main_path</span><span class="p">)</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"{}/02 Data"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">main_path</span><span class="p">)</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"{}/03 Output"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">main_path</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="loading-assetreturns">Loading asset returns</h2>

<p>In order to make the financial theory come alive, we need to create financial return time-series data. In order to work with real financial returns, we use the yahoo finance API. This is done by using the pandas webreader. This powerful package can, among others, download historical price data for different stock tickers. A stock ticker is the abbreviation of a company name used at the stock exchange. For example, the ticker-name of Apple is AAPL. An extensive list of companies and their stock tickers can be found here.</p>

<p>After downloading the aforementioned excel, we upload them into Python with the following lines.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Loading the tickers
</span><span class="n">ticker_excel</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"{}/ticker.xlsx"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">raw_path</span><span class="p">))</span>
<span class="n">ticker_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ticker_excel</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">:,</span> <span class="s">"Yahoo Stock Tickers"</span><span class="p">])</span>
</code></pre></div></div>
<p>Now it is time to build a function with which we can create financial returns for a certain number of assets. As the input parameters we select the number of return time-series we would like and for how many years back from today we would like them. The following function allows us exactly that.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">financial_dataframe_creation</span><span class="p">(</span><span class="n">ticker_list</span><span class="p">,</span>
                                 <span class="n">number_of_stocks</span><span class="p">,</span>
                                 <span class="n">starting_year</span><span class="p">):</span>
    <span class="s">"""
    This function imports finanial price data from yahoo from a
    pre-defined list of stock-tickers.
Parameters
    ----------
    ticker_list : list
        list with stock-tickers used by yahoo finance
    number_of_stocks : int
        number of stocks desired in the final dataframe
    starting_year : TYPE
        year from which we would like to extract financial data from
Returns
    -------
    returns : dataframe
        this dataframe contains daily returns for as many
        stocks as were specified in the beginning
"""</span>
<span class="n">df_prices</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_prices</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="n">number_of_stocks</span><span class="p">:</span>
        <span class="n">ticker</span> <span class="o">=</span> <span class="n">ticker_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">web</span><span class="p">.</span><span class="n">DataReader</span><span class="p">(</span><span class="n">ticker</span><span class="p">,</span> <span class="s">"yahoo"</span><span class="p">,</span>
                                 <span class="s">"1/1/{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">starting_year</span><span class="p">),</span>
                                 <span class="n">dt</span><span class="p">.</span><span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">())</span>
            <span class="n">df_prices</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ticker</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">[</span><span class="s">'Adj Close'</span><span class="p">]</span>
        <span class="k">except</span> <span class="nb">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">except</span> <span class="n">RemoteDataError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">returns</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">df_prices</span> <span class="o">/</span> <span class="n">df_prices</span><span class="p">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">252</span>
<span class="k">return</span> <span class="n">returns</span>
</code></pre></div></div>

<p>Before tackling any question we go for a test-run of the function to see whether it returns the desired output. The following code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">min_year_restriction</span> <span class="o">=</span> <span class="mi">2010</span>
<span class="n">number_of_stocks</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">returns</span> <span class="o">=</span> <span class="n">financial_dataframe_creation</span><span class="p">(</span><span class="n">ticker_list</span><span class="p">,</span>
                                       <span class="n">number_of_stocks</span><span class="p">,</span>
                                       <span class="n">min_year_restriction</span><span class="p">)</span>
</code></pre></div></div>

<p>results in this output:</p>

<p><img src="/assets/post_images/portfolio/picture1_1.png" alt="" /></p>

<p>We can see that the different assets are now displayed as columns names and we find one annualized return information for every day of our time series. With the knowledge that our function works, we can start to answer the questions.</p>

<h2 id="the-more-stocks-in-the-portfolio-the-lower-the-overallrisk">“The more stocks in the portfolio the lower the overall risk”</h2>

<h3 id="theory">Theory</h3>

<p>This statement might seem counter-intuitive at first glance. Having more stocks in your portfolio might seem that there are more things that could go wrong. The reason that this is not the case is related to a concept called diversification.</p>

<p>Imagine that you only have one stock in your portfolio. In that scenario your portfolio is predominately exposed to two kind of risks: Market risks and firm-specific risks.</p>

<p>The firm-specific risks are specific to one individual firm. These risks range from a sudden death of the CEO (assumed to be negative news) up to unexpectedly finding oil on the company’s grounds (assumed to be positive news). Note that if an investor is only carrying one stock in their portfolio, they are heavily exposed to these company-specific risks.</p>

<p>Market risks compromises risk that affect macroeconomic factors like interest rate changes, inflation, unemployment, and so on. If for example the global economy enters a recession and overall fewer goods are sold and bought, the one individual firm in the investor’s portfolio is also going to be affected by it.</p>

<p>When now investing not in one, but in multiple stocks, the company specific risk reduces quite massively given its small contribution to the overall portfolio performance. The market risks on the other hand, given its wide-reaching and all-affecting implications, has an impact on the total portfolio performance nevertheless. Since market risks affect all stocks, they are also referred to as systematic risk. This kind of risk does not reduces when we increase the number of stocks within our portfolio.</p>

<h3 id="empirical-evidence">Empirical Evidence</h3>

<p>In order to validate the financial theory outlined above we create multiple portfolios with an increasing amount of stocks in each portfolio and re-calculate the risk of each.</p>

<p>We start by initializing time series data for 500 stocks, starting in the beginning of 2016 up until today. This is done using the following code</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">min_year_restriction</span> <span class="o">=</span> <span class="mi">2016</span>
<span class="n">number_of_stocks</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">returns</span> <span class="o">=</span> <span class="n">financial_dataframe_creation</span><span class="p">(</span><span class="n">ticker_list</span><span class="p">,</span>
                                       <span class="n">number_of_stocks</span><span class="p">,</span>
                                       <span class="n">min_year_restriction</span><span class="p">)</span>
</code></pre></div></div>

<p>Now we would like to show how the overall portfolio risk reduces when we include more assets in our portfolio. For that we calculate and store the portfolio risk of a given portfolio of the first 25 assets. Afterwards we add further 25 assets to that portfolio and re-calculate the risk again and so on. This is done through the following code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">step_size</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">risk_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">num_stocks_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">num_stocks</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">number_of_stocks</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)):</span>
    <span class="n">portfolio</span> <span class="o">=</span> <span class="n">returns</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num_stocks</span><span class="p">].</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">num_of_companies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">portfolio</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">cov_matrix</span> <span class="o">=</span> <span class="n">portfolio</span><span class="p">.</span><span class="n">cov</span><span class="p">()</span>
    <span class="n">sum_covariances</span> <span class="o">=</span> <span class="n">cov_matrix</span><span class="p">.</span><span class="nb">sum</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">weighting</span> <span class="o">=</span> <span class="n">num_of_companies</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">portfolio_variance</span> <span class="o">=</span> <span class="n">sum_covariances</span> <span class="o">/</span> <span class="n">weighting</span>
    <span class="n">risk</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">portfolio_variance</span><span class="p">)</span>
    <span class="n">risk_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">risk</span><span class="p">)</span>
    <span class="n">num_stocks_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_of_companies</span><span class="p">)</span>
</code></pre></div></div>

<p>When plotting the results we get the following picture:</p>

<p><img src="/assets/post_images/portfolio/picture1_2.png" alt="" /></p>

<p>Our hypothesized reduction in overall portfolio risk with an increasing amount of stocks shows up nicely. The black horizontal line drawn in the graph furthermore depicts the level of risk of a portfolio which cannot be further reduced even when including more stocks into the portfolio. That is because all stocks are going to be affected by the volatility of the market as a whole. This minimum threshold of risk is also called undiversifiable risk, whereas we call the risk which is possible to reduce the diversifiable risk.</p>

<h2 id="the-important-risk-kind-of-an-asset-is-its-covariance-with-other-assets-and-not-its-own-volatility">“The important risk kind of an asset is its covariance with other assets and not its own volatility”</h2>

<h3 id="theory-1">Theory</h3>

<p>The answer to the question of how to calculate the risk of an equity portfolio is easier than one might initially think. It is actually only the sum of the portfolio covariance matrix. The covariance matrix shows each asset’s variance on the diagonal and the covariance with each other asset in the upper and lower diagonal matrix. As an example let us consider the covariance matrix below. The variance are denoted by a light-green shaded background whereas the covariance have a light-red shaded background. It is important to note that the upper diagonal matrix and lower diagonal matrix are identical. That is because the covariance of A and B is equal to the covariance of B and A.</p>

<p><img src="/assets/post_images/portfolio/picture1_3.png" alt="" /></p>

<p>It is important to know how the number of variances and covariance scale with the size of the portfolio. A portfolio with n-assets for example has exactly n variances and n²-n covariances. It is easy to see that with a higher number of n the covariances outnumber the variances significantly.</p>

<h3 id="empirical-evidence-1">Empirical Evidence</h3>

<p>To check whether that is also empirically the case, we implement the following code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">step_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">maximum_number_of_stocks</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">list_num_stocks</span><span class="p">,</span> <span class="n">sum_variances</span><span class="p">,</span> <span class="n">sum_covariances</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">num_stocks</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maximum_number_of_stocks</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
    <span class="n">portfolio</span> <span class="o">=</span> <span class="n">returns</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num_stocks</span><span class="p">]</span>
    <span class="n">covariance_matrix</span> <span class="o">=</span> <span class="n">portfolio</span><span class="p">.</span><span class="n">cov</span><span class="p">()</span>
    <span class="n">list_num_stocks</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">num_stocks</span><span class="p">)</span>
    <span class="n">variance_returns</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="n">covariance_matrix</span><span class="p">))</span>
    <span class="n">sum_variances</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">variance_returns</span><span class="p">)</span>
    <span class="n">sum_covariances</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">covariance_matrix</span><span class="p">.</span><span class="nb">sum</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
                           <span class="o">-</span> <span class="n">variance_returns</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/post_images/portfolio/picture1_4.png" alt="" /></p>

<p>The plot above shows us exactly the hypothesized outcome. The over sum of covariances represents a multifold of the sum of variances of the portfolio. This finding entails interesting implications for the selection process of an asset. The asset’s own variance carries little to no importance for the risk of a well-diversified portfolio.</p>

<h2 id="a-longer-investment-horizon-reduces-the-portfolio-risk">“A longer investment horizon reduces the portfolio risk”</h2>

<h3 id="theory-2">Theory</h3>
<p>The investment horizon describes how an investor plans to hold the portfolio. These ranges can span from merely a few days up to multiple years. When deciding for a longer investment horizon an investor typically allocates most of their assets to a higher risk area, like equities. This is because the larger price swings, equities exhibit in the short term, have no impact on the long-term goals of the investor.</p>

<h3 id="empirical-evidence-2">Empirical Evidence</h3>

<p>The following code shows how we can empirically test this theory.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">number_of_stocks</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">weighting</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">number_of_stocks</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">risk_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">years</span><span class="p">):</span>
    <span class="n">time_returns</span> <span class="o">=</span> <span class="n">financial_dataframe_creation</span><span class="p">(</span><span class="n">ticker_list</span><span class="p">,</span>
                                                <span class="n">number_of_stocks</span><span class="p">,</span>
                                                <span class="n">year</span><span class="p">)</span>
    <span class="n">portfolio_var</span> <span class="o">=</span> <span class="n">weighting</span> <span class="o">*</span> <span class="n">time_returns</span><span class="p">.</span><span class="n">cov</span><span class="p">().</span><span class="nb">sum</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">portfolio_std</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">portfolio_var</span><span class="p">)</span>
    <span class="n">risk_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">portfolio_std</span><span class="p">)</span>
</code></pre></div></div>

<p>The code above first takes 100 arbitrary stocks using our function which we declared in the beginning of this post. Afterwards the portfolio variance for an equally weighted portfolio is calculated for different time-spans. The result is the following plot.</p>

<p><img src="/assets/post_images/portfolio/picture1_5.png" alt="" /></p>

<p>Interestingly, even though we can see an overall trend to a smaller risk level over time, the relationship is not perfectly negative. This is because we find a local minimum after around eight years. This finding is likely to be explained by the financial crisis 2008. Given that we started to track our portfolio performance in the year 2000, after eight years we find our portfolio in one of the most financially unstable times in modern history. After a couple of turbulent years, we find the portfolio risk to decrease again, which is quite an affirmative sign in the direction of our hypothesis that a longer time horizon reduces our portfolio risk.</p>


        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#finance" class="page__taxonomy-item" rel="tag">Finance</a><span class="sep">, </span>
    
      <a href="/categories/#portfolio" class="page__taxonomy-item" rel="tag">Portfolio</a><span class="sep">, </span>
    
      <a href="/categories/#python" class="page__taxonomy-item" rel="tag">Python</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-08-27T00:00:00+02:00">August 27, 2020</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Empirical+Evidence+to+common+Stock+Portfolio+Questions%20http%3A%2F%2Flocalhost%3A4000%2Fportfolio%2Ffinance%2Fpython%2FEmpirical-Evidence-to-common-Stock-Portfolio-Questions%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fportfolio%2Ffinance%2Fpython%2FEmpirical-Evidence-to-common-Stock-Portfolio-Questions%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fportfolio%2Ffinance%2Fpython%2FEmpirical-Evidence-to-common-Stock-Portfolio-Questions%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/signal%20processing/python/Signal-Processing-Engine-Sound-Detection/" class="pagination--pager" title="Signal Processing - Engine Sound Detection
">Previous</a>
    
    
      <a href="/portfolio/finance/python/Markowitz-Portfolio-Theory-An-Empirical-Explanation/" class="pagination--pager" title="Markowitz Portfolio Theory - An empirical explanation
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/classification/tutorial/python/Classifier-Evaluation-Methods-A-Hands-On-explanation/" rel="permalink">Classifier Evaluation Methods - A Hands-On Explanation
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          19 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description"> Accuracy/ Recall/ Precision/ Confusion Matrix/ ROC Curve/ AUC 

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/data%20journalism/web%20scraping/r/How-the-People-Really-Voted/" rel="permalink">How the People Really Voted
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description"> Why geographically correct maps show elections results inaccurately &lt;/em

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/reinforcement%20learning/python/Human-vs.-Machine-Reinforcement-Learning-in-the-Context-of-Snake/" rel="permalink">Human vs. Machine — Reinforcement Learning in the Context of Snake
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">This blogpost elaborates on how to implement a reinforcement algorithm, which not only masters the game “Snake”, it even outperforms any human in a game with...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/data%20journalism/r/United-for-30-Years-Catching-up-to-West-Germany/" rel="permalink">United for 30 Years — Catching up to West Germany
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          14 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description"> Visualizing 30 years of economic data between East and West Germany 

</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="search-searchbar"></div>
  <div class="search-hits"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://github.com/data4help" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Paul Mora. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>


<!-- Including InstantSearch.js library and styling -->
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">

<script>
// Instanciating InstantSearch.js with Algolia credentials
const search = instantsearch({
  appId: 'AZI2EKWO49',
  apiKey: 'af40085957e518d9a9f4b35cf22bb3ca',
  indexName: 'test_NAME',
  searchParameters: {
    restrictSearchableAttributes: [
      'title',
      'content'
    ]
  }
});

const hitTemplate = function(hit) {
  const url = hit.url;
  const title = hit._highlightResult.title.value;
  const content = hit._highlightResult.html.value;

  return `
    <div class="list__item">
      <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
        <div class="archive__item-excerpt" itemprop="description">${content}</div>
      </article>
    </div>
  `;
}

// Adding searchbar and results widgets
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '.search-searchbar',
    poweredBy: true,
    placeholder: 'Enter your search term...'
  })
);
search.addWidget(
  instantsearch.widgets.hits({
    container: '.search-hits',
    templates: {
      item: hitTemplate,
      empty: 'No results',
    }
  })
);

// Starting the search only when toggle is clicked
$(document).ready(function () {
  $(".search__toggle").on("click", function() {
    if(!search.started) {
      search.start();
    }
  });
});
</script>








  </body>
</html>
